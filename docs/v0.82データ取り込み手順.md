# v0.82 データ取り込み手順

**作成日**: 2025-12-23  
**対象**: v0.82へのアップグレード

---

## 🚨 重要: 初回のみマイグレーションが必要です

既存のデータベース(`data/odds_history.db`)が見つかりました。
v0.82を使用する前に、データベースにUNIQUE制約を追加する必要があります。

---

## 📋 手順

### Step 1: データベースのマイグレーション(初回のみ)

コマンドプロンプトで以下を実行:

```bash
cd C:\Users\takuy\Desktop\投資競馬アプリ系\時系列オッズ取得アプリ
python src/migrate_v082.py
```

**実行結果の確認**:
- "Migration completed successfully!" と表示されればOK
- エラーが出た場合は報告してください

---

### Step 2: データ取り込み

マイグレーション完了後、`アプリ起動.bat` をダブルクリックしてください。

メニューが表示されたら:
1. **過去データを取得する** を選択
2. 開始日と終了日を入力
3. データ種別を選択(0B41推奨)

---

## ✅ 確認ポイント

### マイグレーション後の確認
- データベースにUNIQUE制約が追加される
- 既存データは保持される
- 重複データは自動的に除去される

### データ取り込み後の確認
- 複勝オッズ(`odds_fuku_min`, `odds_fuku_max`)が0.0以外で保存される
- 単勝オッズも正常に保存される

---

## 🔧 トラブルシューティング

### マイグレーションでエラーが出た場合
1. データベースファイルのバックアップを取る
2. エラーメッセージを確認
3. 質問してください

### データ取り込みでエラーが出た場合
- JV-Linkが正しくインストールされているか確認
- サービスキーが正しいか確認

---

## 📝 次のステップ

1. マイグレーション実行
2. データ取り込み
3. Webダッシュボードで複勝オッズを確認

**Webダッシュボード起動**:
```bash
python src/api_server.py
```

ブラウザで `http://localhost:5000` にアクセス

---

**準備完了!マイグレーションから始めてください。**
